{% extends "base.html" %}

{% block title %}Welcome to Bartrify{% endblock %}

{% block content %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
<link rel="stylesheet" href="{% static 'css/modals.css' %}">
<main>

  <!-- Left Side Bar -->
  <aside class="left-sidebar" aria-label="Recent chats and search">
    <div class="search-container">
      <input type="search" placeholder="Search" aria-label="Search chats" />
      <i class="fa-sharp fa-solid fa-magnifying-glass"></i>
    </div>
    <h3>Recent Chats</h3>
    <div class="chat-list">
      <button class="chat-button" type="button" onclick="flipCard()">
        <div class="left">
          <img src="https://placehold.co/600x400/black/white" alt="Placeholder Avatar" />
          <span>Flip to Chat</span>
        </div>
        <i class="fa-solid fa-arrows-rotate fa-spin"></i>
      </button>
      <br>
      <button class="chat-button" type="button">
        <div class="left">
          <img src="https://placehold.co/600x400/black/white" alt="Placeholder Avatar" />
          <span>Alex</span>
        </div>
        <i class="fas fa-ellipsis-h"></i>
      </button>
      <button class="chat-button" type="button">
        <div class="left">
          <img src="https://placehold.co/600x400/black/white" alt="Placeholder Avatar" />
          <span>Maia</span>
        </div>
        <i class="fas fa-ellipsis-h"></i>
      </button>
      <button class="chat-button" type="button">
        <div class="left">
          <img src="https://placehold.co/600x400/black/white" alt="Placeholder Avatar" />
          <span>Ruca</span>
        </div>
        <i class="fas fa-ellipsis-h"></i>
      </button>
    </div>
    <button class="edit-profile-btn" id="openBtn2" type="button">
      <img src="https://placehold.co/600x400/black/white" alt="Avatar" />
      <span>Edit Profile</span>
      <i class="fa-solid fa-gear"></i>
    </button>
  </aside>

  <div class="dashboard-container" id="dashboard-container">
    <div class="dashboard-card" id="dashboard-card">
      <!-- Dashboard Side-->
      <div class="dashboard-card-side dashboard-card-front" id="dashboard-card-front">
        <section class="center-content" aria-label="User profile and active exchanges" id="dashboard-container">
          <div class="profile-top">
            <img src="https://placehold.co/600x400/black/white" alt="Placeholder Avatar" class="profile-image" />
            <div class="profile-info">
              <h2>John Doe</h2>
              <p id="editableText">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
                incididunt ut labore et dolore magna aliqua.</p>
              <button id="editPopupBtn">Edit My Bio</button>
              <div class="tags">
                <span class="tag gardening">Gardening</span>
                <span class="tag mechanic">Mechanic</span>
                <span class="tag eletricit">Eletricit</span>
              </div>
            </div>
            <div class="ratings" aria-label="Ratings">
              <h3>Ratings</h3>
              <div class="circle-rating" role="img" aria-label="Rating 5 out of 5">
                <div class="circle-text">
                  <div class="rating">5/5</div>
                  <div class="label">Excellent</div>
                </div>
              </div>
              <p class="reviews">30+ Reviews</p>
            </div>
          </div>
          <div>
            <div class="active-exchanges-header">
              <h3>Active Exchanges</h3>
            </div>
            <div class="tabs-wrapper">
              <div class="tabs">
                <span class="tab active" role="tab" aria-selected="true" tabindex="0">Active Exchanges</span>
                <span class="tab inactive" role="tab" tabindex="-1">Created Services</span>
                <span class="tab inactive" role="tab" tabindex="-1">Completed Exchanges</span>
              </div>
              <button class="add-service-btn" id="openBtn" type="button">
                Add a Service
              </button>
            </div>

            <div>
              <div class="exchange-item">
                <strong>Abelha: Interior Designer</strong>
                <p>Name: Abelha Maia</p>
                <p>Exchange: Interior Design for your Mechanic Skill</p>
                <span class="status">On-going</span>
              </div>
              <div class="exchange-item">
                <strong>Ruca: Web Dev</strong>
                <p>Name: Ruca</p>
                <p>Exchange: Web Site for your Mechanic Skill</p>
                <span class="status">On-going</span>
              </div>
              <div class="exchange-item">
                <strong>Alex: Gardening</strong>
                <p>Name: Alex</p>
                <p>Exchange: Gardening for your Eletricist Skill</p>
                <span class="status">On-going</span>
              </div>
            </div>
          </div>
        </section>
      </div>
      <!-- Chat Side-->
      <div class="dashboard-card-side dashboard-card-back" id="dashboard-card-back" style="display:flex; flex-direction: column;">
        <header class="chat-header">
          Alex
          <button aria-label="Close chat"
            class="text-gray-500 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-blue-500">
            <i class="fas fa-times"></i>
          </button>
        </header>
        <div class="chat-messages" tabindex="0" aria-live="polite" aria-relevant="additions">
          <div class="message-left" role="article" aria-label="Message from Alex">
            <img src="https://placehold.co/600x400/black/white" alt="Placeholder Avatar" class="message-avatar"/>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla dapibus, sapien et volutpat placerat, arcu
              mauris blandit justo, in porttitor mi nisi scelerisque dolor.</p>
          </div>
          <div class="message-right" role="article" aria-label="Your message">
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla dapibus, sapien et volutpat placerat, arcu
              mauris blandit justo, in porttitor mi nisi scelerisque dolor.</p>
            <img src="https://placehold.co/600x400/black/white" alt="Placeholder Avatar" class="message-avatar" />
          </div>
          <div class="message-right" role="article" aria-label="Your message">
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla dapibus, sapien et volutpat placerat, arcu
              mauris blandit justo, in porttitor mi nisi scelerisque dolor.</p>
            <img src="https://placehold.co/600x400/black/white" alt="Placeholder Avatar" class="message-avatar"/>
          </div>
        </div>
        <form class="chat-input-area" onsubmit="event.preventDefault()">
          <input aria-label="Type your message" autocomplete="off" class="chat-input" placeholder="Message"
            type="text" />
          <button aria-label="Attach file" class="attach-button" type="button">
            <i class="fas fa-paperclip"></i>
          </button>
          <button class="send-button" type="submit">SEND MESSAGE</button>
        </form>
      </div>
    </div>
  </div>

  <aside class="right-sidebar" aria-label="Stats and exchanges graph">
    <section class="stats">
      <h3>Stats</h3>
      <div class="stat-item">
        <div class="stat-icon" aria-hidden="true"><i class="fas fa-exchange-alt"></i></div>
        <div class="stat-text">
          <p>Exchanges made</p>
          <p>100+</p>
          <div class="stat-bar"></div>
        </div>
      </div>
      <div class="stat-item">
        <div class="stat-icon" aria-hidden="true"><i class="fas fa-rocket"></i></div>
        <div class="stat-text">
          <p>Profile views</p>
          <p>300+</p>
          <div class="stat-bar"></div>
        </div>
      </div>
      <div class="stat-item">
        <div class="stat-icon" aria-hidden="true"><i class="fas fa-wallet"></i></div>
        <div class="stat-text">
          <p>Profile Reviews</p>
          <p>1345</p>
          <div class="stat-bar"></div>
        </div>
      </div>
    </section>
    <section class="graph-container">
      <h3>Exchanges Graph</h3>
      <div class="graph-header">
        <button aria-label="Previous month"><i class="fas fa-chevron-left"></i></button>
        <div class="graph-month">
          June<br />
          <small>2025</small>
        </div>
        <button aria-label="Next month"><i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="graph-bars" aria-hidden="true">
        <div class="bar blue" style="height: 40%;"></div>
        <div class="bar blue" style="height: 70%;"></div>
        <div class="bar blue" style="height: 40%;"></div>
        <div class="bar blue" style="height: 80%;"></div>
        <div class="bar orange" style="height: 20%;"></div>
      </div>
      <div class="graph-labels">
        <span>1</span>
        <span>2</span>
        <span>3</span>
        <span>4</span>
        <span>5</span>
      </div>
      <div class="graph-stats">
        <p>Today <span>4</span></p>
        <p>Best <span>12</span></p>
        <p>Average <span>3</span></p>
      </div>
    </section>
  </aside>
  {% include "core/profile_modal.html" %}
  {% include "core/service_modal.html" %}
  {% include "core/bio_modal.html" %}
</main>
<style>
  .dashboard-card-side dashboard-card-back {
    font-family: 'outfit', sans-serif!important;
     margin: 0;
     min-height: 100vh;
     display: flex;
     justify-content: center;
     align-items: center;
     padding: 1rem;
  }

   .chat-container {
     background: white;
     border-radius: 0.5rem;
     width: 100%;
     max-width: 600px;
     max-height: 90vh;
     display: flex;
     flex-direction: column;
     box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
   }
   .chat-header {
     border-bottom: 1px solid rgba(0,0,0,0.1);
     padding: 0.5rem 1rem;
     font-weight: 600;
     font-size: 0.75rem;
     color: #1e293b;
     display: flex;
     justify-content: space-between;
     align-items: center;
   }
   .chat-messages {
     flex: 1;
     overflow-y: auto;
     padding: 1.5rem 1.5rem 1rem 1.5rem;
     display: flex;
     flex-direction: column;
     gap: 1.5rem;
     background: #f9fafb; /* Tailwind gray-50 */
   }
   .message-left, .message-right {
     max-width: 220px;
     font-size: 0.75rem;
     line-height: 1.2;
     display: flex;
     align-items: flex-start;
     gap: 0.5rem;
   }
   .message-left {
     background: #7c9b9585;
     border-radius: 0.375rem;
     padding: 1rem;
     color: #000;
   }
   .message-right {
     background: #cecece;
     border-radius: 0.375rem;
     padding: 1rem;
     color: #000;
     margin-left: auto;
     flex-direction: row-reverse;
   }
   .message-avatar {
     width: 32px;
     height: 32px;
     border-radius: 9999px;
     flex-shrink: 0;
   }
   .chat-input-area {
     border-top: 1px solid rgba(0,0,0,0.1);
     padding: 1rem 1.5rem;
     display: flex;
     gap: 1rem;
     align-items: center;
     background: white;
     flex-direction: row;;
   }
   .chat-input {
     flex: 1;
     border: 1px solid rgba(0,0,0,0.2);
     border-radius: 5px;
     padding: 0.5rem 1rem;
     font-size: 0.75rem;
     outline: none;
     transition: border-color 0.2s;
     width: 80%;
   }
   .chat-input:focus {
     border-color: #2f4a5a;
     box-shadow: 0 0 0 2px #a3cef1;
   }
   .attach-button {
     background: transparent;
     border: none;
     color: rgba(0,0,0,0.5);
     cursor: pointer;
     font-size: 1rem;
     padding: 0.25rem;
     transition: color 0.2s;
   }
   .attach-button:hover {
     color: #2f4a5a;
   }
   .send-button {
     background-color: #2f4a5a;
     color: white;
     font-weight: 600;
     font-size: 0.75rem;
     padding: 0.5rem 1.5rem;
     border-radius: 0.375rem;
     box-shadow: 0 4px 6px rgba(0,0,0,0.3);
     cursor: pointer;
     transition: filter 0.2s;
     white-space: nowrap;
   }
   .send-button:hover {
     filter: brightness(1.1);
   }
   @media (max-width: 640px) {
     .chat-container {
       max-width: 100%;
       max-height: 100vh;
       border-radius: 0;
     }
     .chat-input-area {
       padding: 0.75rem 1rem;
     }
     .send-button {
       padding: 0.5rem 1rem;
       font-size: 0.7rem;
     }
    }

/* ===========================  */
  aside.right-sidebar {
    width: 15rem;
  }

  .dashboard-container {
    width: 75%;
  }

  .dashboard-card {
    height: 100%;
    position: relative;
    transition: transform 0.8s;
    transform-style: preserve-3d;
  }

  .dashboard-container.flipped .dashboard-card {
    transform: rotateY(180deg);
  }

  .dashboard-card-side {
    position: absolute;
    width: 100%;
    height: 100%;
    display: flex;
    background: white;
    border-radius: 0.5rem;
    overflow: hidden;
    backface-visibility: hidden;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
  }

  .dashboard-card-front {
    flex-direction: row;
  }

  .dashboard-card-back {
    transform: rotateY(180deg);
  }
</style>
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
<script>
  const tabs = document.querySelectorAll(".tabs .tab");

  tabs.forEach(tab => {
    tab.addEventListener("click", () => {
      tabs.forEach(t => {
        t.classList.remove("active");
        t.classList.add("inactive");
        t.setAttribute("aria-selected", "false");
        t.setAttribute("tabindex", "-1");
      });

      tab.classList.remove("inactive");
      tab.classList.add("active");
      tab.setAttribute("aria-selected", "true");
      tab.setAttribute("tabindex", "0");
    });
  });
</script>
<script>
  function flipCard() {
    document.getElementById('dashboard-container').classList.toggle('flipped');
  }
</script>
<script>var myEditableElement = document.getElementById('myContent');
  myEditableElement.addEventListener('input', function () {
  });</script>
<script src="{% static 'js/service_modal.js' %}"></script>
<script src="{% static 'js/profile_modal.js' %}"></script>
{% endblock %}